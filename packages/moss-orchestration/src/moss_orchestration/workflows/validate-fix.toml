# State machine workflow: analyze → fix → verify loop
# Demonstrates conditional transitions based on action results

[workflow]
name = "validate-fix"
description = "Analyze, fix errors, verify in a loop"
initial_state = "analyzing"

[workflow.context]
strategy = "flat"

[workflow.retry]
strategy = "fixed"
max_attempts = 2
delay = 1.0

# States

[[states]]
name = "analyzing"
action = "analyze --health"

[[states.transitions]]
condition = "has_errors"
next = "fixing"

[[states.transitions]]
next = "done"

[[states]]
name = "fixing"
action = "edit . 'fix issues found'"

[[states.transitions]]
next = "verifying"

[[states]]
name = "verifying"
action = "analyze --health"

[[states.transitions]]
condition = "has_errors"
next = "fixing"

[[states.transitions]]
next = "done"

[[states]]
name = "done"
terminal = true
