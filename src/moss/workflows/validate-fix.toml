# Validate-fix workflow: Run validation, analyze errors, apply fixes
# This is the canonical error-fixing loop used by repair agents.

[workflow]
name = "validate-fix"
description = "Validate changes and fix errors in a loop"
version = "1.0"

[workflow.limits]
max_steps = 10
token_budget = 50000
timeout_seconds = 300

[workflow.llm]
model = "gemini/gemini-3-flash-preview"
temperature = 0.0
system_prompt = "@prompts/terse"

[[workflow.steps]]
name = "validate"
tool = "validator.run"
type = "tool"
on_error = "skip"

[[workflow.steps]]
name = "analyze"
tool = "llm.analyze"
type = "llm"
input_from = "validate"
prompt = "@prompts/repair-engine"

[[workflow.steps]]
name = "fix"
tool = "patch.apply"
type = "tool"
input_from = "analyze"
max_retries = 3
