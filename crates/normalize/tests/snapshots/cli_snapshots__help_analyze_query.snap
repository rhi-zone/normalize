---
source: crates/normalize/tests/cli_snapshots.rs
expression: "snapshot_help(&[\"analyze\", \"query\"])"
---
Test a tree-sitter query against files

Supports two pattern syntaxes (auto-detected): - Tree-sitter S-expression: (call_expression function: (identifier) @fn) - ast-grep pattern: $FN($ARGS)

Usage: normalize analyze query [OPTIONS] <PATTERN> [PATH]

Arguments:
  <PATTERN>
          Pattern to search for (tree-sitter S-expr or ast-grep pattern)

  [PATH]
          File or directory to search (searches all files if omitted)

Options:
      --show-source
          Show full matched source code

  -C, --context <CONTEXT>
          Lines of context to show in preview

      --json
          Output as JSON

      --jsonl
          Output as JSON Lines (one object per line)

      --jq <EXPR>
          Filter JSON output with jq expression (implies --json)

      --pretty
          Human-friendly output with colors and formatting

      --compact
          Compact output without colors (overrides TTY detection)

      --output-schema
          Output JSON schema for the command's return type

      --input-schema
          Output JSON schema for the command's input arguments

      --params-json <JSON>
          Pass command arguments as JSON (overrides CLI args)

  -r, --root <ROOT>
          Root directory (defaults to current directory)

      --exclude <PATTERN>
          Exclude paths matching pattern or @alias

      --only <PATTERN>
          Include only paths matching pattern or @alias

      --diff [<BASE>]
          Analyze only files changed since base ref (e.g., main, HEAD~1) If no BASE given, defaults to origin's default branch

  -h, --help
          Print help (see a summary with '-h')
